controller_manager:
  ros__parameters:
    update_rate: 50   # 20 ms control loop

    bang_bang_circle_controller:
      type: bang_bang_controller/BangBangCircleController

bang_bang_circle_controller:
  ros__parameters:
    use_sim_time: true

    # ---------- Orbit guidance ----------
    r0: 1.0
    v_tan_des: 0.2

    # Scaled for ~15 kg (x15 vs 1 kg tuning)
    k_r: 37.5
    k_dr: 60.0
    k_ir: 0.30

    radial_i_limit: 0.03
    radial_i_zone: 0.06
    radial_i_leak: 1.0

    k_t: 52.5
    k_cent: 1.0

    enable_tangential_control: true
    enable_centripetal_ff: true
    enable_radial_integral: false
    use_odom_twist: true

    # ---------- Attitude control ----------
    k_yaw: 5.0
    k_yaw_rate: 5.0

    yaw_deadband: 0.02
    yaw_on_threshold: 0.45
    yaw_off_threshold: 0.20

    yaw_rate_limit: 0.6
    yaw_rate_error_on_threshold: 0.015
    yaw_rate_error_off_threshold: 0.02

    yaw_surface_gain: 1.3
    yaw_surface_on_threshold: 0.015
    yaw_surface_off_threshold: 0.012

    yaw_ref_rate_limit: 0.15
    use_geometric_yaw_rate: true
    yaw_min_speed_for_control: 0.05

    attitude_enable_radial_tol: 0.12
    attitude_enable_vtan_tol: 0.12

    # ---------- Actuator limits ----------
    enable_attitude_control: false

    # ---------- Target ----------
    target_x: 0.0
    target_y: 0.0

    # ---------- Safety / Debug ----------
    enable_debug: true
    odom_timeout: 2.0
    require_fresh_odom: false
